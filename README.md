# MAC Forgery Attack & HMAC Defense

This project demonstrates a real-world **length extension attack** on an insecure MAC scheme using `MD5(secret + message)`, and how switching to `HMAC(secret, message)` effectively prevents the attack.

---

## Project Structure

| File              | Description |
|-------------------|-------------|
| `client.py`        | Performs the length extension attack using `hashpumpy` |
| `server.py`        | Simulates a vulnerable server using `MD5(secret + message)` |
| `securedserver.py` | Secure server using `HMAC` with `MD5` to prevent forgery |
| `Bonus.pdf`        | Project report (manual steps, results) |
| `README.md`        | This documentation file |

---

## Requirements

- Python 3.10+
- [hashpumpy](https://github.com/bwall/HashPump)

Install using:

```bash
pip install hashpumpy
```

---

##  How to Run the Project

### 1. Run the vulnerable server
```bash
python3 server.py
```
It will display:
- The original message
- The MAC generated by `MD5(secret + message)`

---

### 2. Run the attacker client
```bash
python3 client.py
```

Enter:
- Intercepted message
- Intercepted MAC
- Data to append (e.g., `&admin=true`)
- Guessed secret length (e.g., 14)

It will output:
- A forged MAC
- A forged message (with internal MD5 padding)

---

### 3. Inject into `server.py`
- Replace values of `forged_message` and `forged_mac` in `server.py`
- Rerun `server.py`

Expected Output:
```
MAC verified successfully (unexpected).
```

---

### 4. Try the secure server
Copy the same forged values into `server_hmac.py` and run:
```bash
python3 server_hmac.py
```

Expected Output:
```
HMAC verification failed (as expected).
```

---

##  Summary

- `MD5(secret + message)` is **vulnerable** to length extension attacks.
- `HMAC(secret, message)` is **secure** and **resists forgery**.
- This project proves both the attack and the defense in action.

---

**Author:** mariam  
**Platform:** Kali Linux  
**Tools:** Python, hashpumpy, hashlib, hmac
